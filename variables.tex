
%%%
% Math packages
%%%
\usepackage{amssymb,amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{mathtools}
\usepackage{nicematrix}
\usepackage{bbm}
\usepackage{thmtools,thm-restate}

%%%%%%
% Theorems
%%%%%%
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{assumption}{Assumption}


%%%%%
% Number sets
%%%%%
\newcommand{\Integers}{\mathbb{Z}}
\newcommand{\Naturals}{\mathbb{N}}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\RR}{\mathbb{R}}

%%%%%%
% Mathematical operations
%%%%%%

% Probabilites
\newcommand{\Prob}{p}
\newcommand{\prob}{p}
\renewcommand{\Pr}{p}

% Expectations
\newcommand{\E}{\mathbb{E}}
\newcommand{\Expected}{\mathbb{E}}
\newcommand{\Expectation}{\mathbb{E}}
\newcommand{\expect}{\operatorname{\mathbb{E}}\expectarg}
\DeclarePairedDelimiterX{\expectarg}[1]{[}{]}{%
\ifnum\currentgrouptype=16 \else\begingroup\fi
\activatebar#1
\ifnum\currentgrouptype=16 \else\endgroup\fi
}

\newcommand{\innermid}{\nonscript\;\delimsize\vert\nonscript\;}
\newcommand{\activatebar}{%
\begingroup\lccode`\~=`\|
\lowercase{\endgroup\let~}\innermid
\mathcode`|=\string"8000
}

% Variance
\newcommand{\V}{\mathbb{V}}
\newcommand{\Variance}{\mathbb{V}}

% define equals
\newcommand*{\defeq}{\stackrel{\mathsmaller{\mathsf{def}}}{=}}


% misc linear algebra
\newcommand{\trans}{\top}
\newcommand{\transpose}{{\raisebox{.2ex}{$\scriptscriptstyle\top$}}}
\DeclareMathOperator{\tr}{tr}
\newcommand{\inv}{{\raisebox{.2ex}{$\scriptscriptstyle-1$}}}
\newcommand{\invt}{{\raisebox{.2ex}{$\scriptscriptstyle-\top$}}}
\newcommand{\pinv}{{\raisebox{.2ex}{$\scriptscriptstyle\dagger$}}}
\newcommand{\pinvt}{{\raisebox{.2ex}{$\scriptscriptstyle\dagger\top$}}}

% vector w/ two things in it.
\newcommand{\twovec}[2]{{\small \Big[\!\! \begin{array}{c}
#1\\
#2 
\end{array}
\!\!\Big] }}

% Partial Derivative
\newcommand{\partialderivative}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}

% Kronecker delta
\newcommand{\kron}{\delta}


% indicator
\newcommand{\indicator}{\mathbbm{1}}


%%%%%
% Variables
%%%%%

% Matrices
\newcommand{\Amat}{\mathbf{A}}
\newcommand{\Bmat}{\mathbf{B}}
\newcommand{\Cmat}{\mathbf{C}}
\newcommand{\Dmat}{\mathbf{D}}
\newcommand{\Hmat}{\mathbf{H}}
\newcommand{\Kmat}{\mathbf{K}}
\newcommand{\Lmat}{\mathbf{L}}
\newcommand{\Pmat}{\mathbf{P}}
\newcommand{\Ppi}{\mathbf{P}^\pi}
\newcommand{\Qmat}{\mathbf{Q}}
\newcommand{\Rmat}{\mathbf{R}}
\newcommand{\Tmat}{\mathbf{T}}
\newcommand{\Umat}{\mathbf{U}}
\newcommand{\Vmat}{\mathbf{V}}
\newcommand{\Wmat}{\mathbf{W}}
\newcommand{\Xmat}{\mathbf{X}}
\newcommand{\Zmat}{\mathbf{Z}}

% Vectors
\newcommand{\avec}{\mathbf{a}}
\newcommand{\bvec}{\mathbf{b}}
\newcommand{\cvec}{\mathbf{c}}
\newcommand{\dvec}{\mathbf{d}}
\newcommand{\evec}{\mathbf{e}}
\newcommand{\fvec}{\mathbf{f}}
\newcommand{\gvec}{\mathbf{g}}
\newcommand{\hvec}{\mathbf{h}}
\newcommand{\ivec}{\mathbf{o}}
\newcommand{\lvec}{\mathbf{l}}
\newcommand{\mvec}{\mathbf{m}}
\newcommand{\nvec}{\mathbf{n}}
\newcommand{\pvec}{\mathbf{p}}
\newcommand{\qvec}{\mathbf{q}}
\newcommand{\rvec}{\mathbf{r}}
\newcommand{\svec}{\mathbf{s}}
\newcommand{\uvec}{\mathbf{u}}
\newcommand{\vvec}{\mathbf{v}}
\newcommand{\wvec}{\mathbf{w}}
\newcommand{\xvec}{\mathbf{x}}
\newcommand{\yvec}{\mathbf{y}}
\newcommand{\zvec}{\mathbf{z}}

\newcommand{\alphavec}{\boldsymbol{\alpha}}
\newcommand{\phivec}{\boldsymbol{\phi}}
\newcommand{\psivec}{\boldsymbol{\psi}}
\newcommand{\thetavec}{\boldsymbol{\theta}}

% zero vector
\newcommand{\zerovec}{\mathbf{0}}

% yhat
\newcommand{\yhat}{\hat{y}}

%%%%
% Dimensions and sizes of things
%%%%
\newcommand{\xdim}{d}
\newcommand{\pdim}{k}
\newcommand{\nsamples}{T}
\newcommand{\nstates}{n}
\newcommand{\statesize}{n}
\newcommand{\obssize}{m}
\newcommand{\astatesize}{b}
\newcommand{\agentstatesize}{n}
\newcommand{\numgvfs}{N}
\newcommand{\numparams}{d}

%%%%
% various function parameters
%%%%
\newcommand{\regwgt}{\eta}
\newcommand{\decay}{\beta}
\newcommand{\stepsize}{\alpha}
\newcommand{\avewgt}{\epsilon}

%%%% 
% Learnable Weights
%%%%
\newcommand{\weightmat}{\Wmat}
\newcommand{\weightvec}{\wvec}
\newcommand{\weights}{\weightmat}
\newcommand{\weightspace}{\boldsymbol{\Omega}}
% \newcommand{\secweights}{\wvec}

%%%%
% Reinforcement learning specific
%%%%

% actions
\newcommand{\Actions}{\mathcal{A}}
\newcommand{\Action}{A}
\newcommand{\action}{a}
\newcommand{\actionsize}{b}

% environment states
\newcommand{\EnvStates}{\boldsymbol{\Psi}}
\newcommand{\EnvState}{\Psi}
\newcommand{\envstate}{\psi}

% agent states
\newcommand{\States}{\mathcal{S}}
\newcommand{\State}{S}
\newcommand{\state}{\agentstate}
\newcommand{\pstate}{\tilde{s}}
\newcommand{\ipstate}{\tilde{s}}

% observations
\newcommand{\Observations}{\mathcal{O}}
\newcommand{\obs}{\mathbf{o}}

% features
\newcommand{\feat}{\mathbf{x}}
\newcommand{\Feats}{\zvec}

% histories
\newcommand{\Histories}{\mathcal{H}}
\newcommand{\Hists}{\mathcal{H}}
\newcommand{\Hist}{\mathcal{H}}
\newcommand{\history}{\hvec}
\newcommand{\hist}{\hvec}

% agent state for po
\newcommand{\agentstate}{\svec}
\newcommand{\astate}{\svec}
\newcommand{\interstate}{z}


% rewards and cumulants
\newcommand{\Rewards}{\mathcal{R}}
\newcommand{\reward}{R}
\newcommand{\Cumulant}{C}
\newcommand{\cumulant}{C}
\newcommand{\cfunc}{c}


% MDP dynamic functions
\newcommand{\Pfcn}{\mathrm{P}}
\newcommand{\PSSA}{P_{s,s'}^a}
\newcommand{\Rfcn}{r}
\newcommand{\RSSA}{R_{s,s'}^a}

% Value functions
\newcommand{\Value}{V}
\newcommand{\vfunc}{V}
\newcommand{\vifunc}[1]{V^{(#1)}}
\newcommand{\viweights}[1]{V^{(#1)}_\weights}

\newcommand{\QValue}{\mathcal{Q}}

\newcommand{\valuevec}{\mathbf{g}}
\newcommand{\rewardvec}{\mathbf{r}}

% RL policy induced distributions
\newcommand{\dmu}{\mathbf{d}_\mu}
\newcommand{\bpolicy}{\mu}
\newcommand{\tpolicy}{\pi}
\newcommand{\bpi}{\mathbf{b}}
\newcommand{\dstat}[1]{\mathbf{d}_{#1}}
\newcommand{\behaviorPolicy}{\mu}
\newcommand{\questionPolicy}{\pi}
\newcommand{\optpolicy}{\pi^*}

% importance sampling
\newcommand{\rhomat}{\mathcal{P}}
\newcommand{\rhovec}{\boldsymbol{\rho}}

% error funcs
\newcommand{\tderror}{\boldsymbol{\delta}}
\newcommand{\tdnerror}{\boldsymbol{\delta_{TDN}}}
\newcommand{\loss}{\mathcal{L}}

% projection operator
\newcommand{\proj}{\Pi}


% Math Functions
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\diag}{diag}

% useful constants
\newcommand{\ralignspace}{\vspace{-0.15cm}}
\newcommand{\balignspace}{\par\vspace{-0.2cm}}



%%%%%%%%%%
%
% Paper Specific variables
% 
%%%%%%%%%%


%%%%
% Resampling
%%%%

\newcommand{\cumul}{c}
\newcommand{\cumulr}{C}
\newcommand{\stater}{S}
\newcommand{\actionr}{A}
% \renewcommand{\Value}{V}

\newcommand{\xiwer}{X_{\mathrm{IR}}}
\newcommand{\xbciwer}{X_{\mathrm{BC}}}
\newcommand{\xbciwerb}[1]{X_{\mathrm{BC}}^{(#1)}}
\newcommand{\xwis}{X_{\mathrm{WIS}^*}}
\newcommand{\xis}{X_{\mathrm{IS}}}
\newcommand{\xwindow}[1]{X_{#1}}
\newcommand{\Var}{\mathrm{Var}}

\newcommand{\bsize}{n}

\newcommand{\varReduction}{\V_{\text{reduc}}}
\newcommand{\irsample}{{i_j}}
\newcommand{\unisample}{{z_j}}
\newcommand{\muB}[1]{\mu_{#1}}

%%%%
% ARNNs
%%%%
% number of factors
\newcommand{\factors}{M}

%%%%
% GVFNs
%%%%

\newcommand{\vit}[2]{\mathbf{V}^{(#1)}_{#2}}
\newcommand{\vi}[1]{\mathbf{V}^{(#1)}}
\newcommand{\vt}[1]{\mathbf{V}_{#1}}
\newcommand{\vinone}{\mathbf{V}}
\newcommand{\Bn}{\mathbf{B}}

\newcommand{\Lmattilde}{\tilde{\Lmat}}
\newcommand{\Rmattilde}{\tilde{\Rmat}}

\newcommand{\Arank}{\hat{\mathbf{A}}}
\newcommand{\Api}{\mathbf{A}}

\newcommand{\Cpi}{\mathbf{C}}
\newcommand{\Cpij}[1]{\mathbf{C}^{(#1)}}
\newcommand{\Ppigamma}{\mathbf{P}}
\newcommand{\Ppigammaj}[1]{\mathbf{P}^{(#1)}}
\newcommand{\pij}[1]{\pi^{(j)}}
\newcommand{\gammaj}[1]{\gamma^{(#1)}}
\newcommand{\cj}[1]{c^{(#1)}}
\newcommand{\crj}[1]{C^{(#1)}}

\newcommand{\Lambdamat}{\boldsymbol{\Lambda}}
\newcommand{\Phimat}{\boldsymbol{\Phi}}
\newcommand{\phimat}{\boldsymbol{\Phi}}
\newcommand{\Sigmamat}{\boldsymbol{\Sigma}}
\newcommand{\Etamat}{\boldsymbol{H}}
\newcommand{\Gammamat}{\boldsymbol{\Gamma}}
\newcommand{\gammamat}{\boldsymbol{\Gamma}}


\newcommand{\LL}{\lambda}

\newcommand{\dw}{\mathbf{d}}
\newcommand{\dwdiag}{\mathbf{D}}

\newcommand{\gradHistMatrix}{\boldsymbol{\Phi}}

\newcommand{\activation}{\sigma}
\newcommand{\actdot}{\dot{\sigma}}
\newcommand{\actdotdot}{\ddot{\sigma}}
\newcommand{\featfunction}{f}
\newcommand{\featuresize}{(\xsize+\valuesize)}
\newcommand{\rewardsize}{(\xsize+\valuesize)}
\newcommand{\xsize}{d}
\newcommand{\valuesize}{n}
% \newcommand{\statesize}{\numgvfs}

\newcommand{\Roperator}{\mathcal{R}}

\newcommand{\valuedr}{\boldsymbol{\xi}}
\newcommand{\valuedtheta}{\mathbf{u}}
\newcommand{\RopValueVect}{({\mathcal{R}_t})_{w,V}}
\newcommand{\krondelta}{\delta^\kappa}

\newcommand{\secweights}{\uvec}


% Resampling
\newcommand{\Cov}{\mathrm{Cov}}

% \newcommand{\cumul}{c}
% \newcommand{\cumulr}{C}
% \newcommand{\stater}{S}
% \newcommand{\actionr}{A}
% \newcommand
% \renewcommand{\Value}{V}

% \newcommand{\dummycite}[1]{
%   {[{\bf CITE #1}]}}

